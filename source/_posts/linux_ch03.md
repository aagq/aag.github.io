---
title: 鸟哥的Linux私房菜--Ch03
date: 2017-07-05
tags: linux
---
# Chapter3 主机规划与磁盘分区

## Linux 与硬件的搭配

1. 各种硬件装置在Linux 中的文件名

   注： 在Linux 系统中，每个装置都被当成一个档案来对待。
	
	IDE硬盘机	     /dev/hd[a-d]
	SCSI/SATA/USB硬盘机  /dev/sd[a-p]
	USB 快闪碟           /dev/sd[a-p]
	软盘驱动器	     /dev/fd[0-1]
	鼠标	        USB: /dev/usb/mouse[0-15]
	     		PS2：/dev/psaux

## 磁盘分区

### 磁盘连接的方式与装置文件名的关系

   个人计算机常见的磁盘接口有两种：IDE /SATA(主流）

   **IDE接口**
	
```

由于一个IDE扁平电缆可以链接连个IDE装置，而且通常主机又会提供两个IDE接口，因此，最多可以连接四个IDE装置。

这两个接口通常被称为 IDE1(primary) IDE2（secondary)
每个扁平电缆上的IDE装置可以被区分 Master Slave
```
这四个装置的文件名如下表：

IDE/Jumper  |   Master   |Slave
:----------:|:----------:|:----:
IDE1  |  /dev/hda | /dev/hdb
IDE2  | /dev/hdc  | /dev/hdd

例题：假设你的主机仅有一颗IDE接口的磁盘，而这一颗磁盘接在IDE2的Master上面，请问它在Linux系统中的装置文件名为？

```

根据上表，IDE2的Master的装置文件名为/dev/hdc

```

   **SATA**

```

由于SATA/USB/SCSI等磁盘接口都是使用SCSI模块来驱动的，因此，这些接口的磁盘装置文件名都是/dev/sd[a-p]的格式。

与IDE接口不同的是，SATA/USB接口的磁盘没有一定的顺序。此时，要根据Linux核心检测到的磁盘的顺序决定其装置的文件名。

```

例题:如果你的PC上有两个SATA磁盘和一个USB磁盘，而主板上有六个SATA插槽，这两个SATA磁盘分别安插在主板的SATA1,SATA5插槽上，那么这三个磁盘在Linux的装置文件名是什么？

```
由于是使用检测的顺序来决定装置文件名，并非与实际插槽代号有关，因此，装置的文件名如下:

1. SATA1 上： /dev/sda
2. SATA5 上： /dev/sdb
3. USB（开机后才能被系统检测到）： /dev/sdc

```
### 磁盘的组成复习

磁盘的组成主要有 磁盘盘、机械手臂、磁盘读取头、主轴马达。

数据的写入是在磁盘盘上。磁盘盘又可细分为 扇区(sector) 、磁柱（cylinder)两种单位，其中扇区每个为512bytes。

扇区中第一个特别重要，因为它记录着整个磁盘的重要信息。主要有两个：

- 主要启动记录区（master boost record,MBR）：可以安装开机管理程序的地方，有 446bytes;
- 分割表（partition table):记录整个磁盘分割的状态，64bytes

**注**   
MBR很重要，因为但系统在开机的时候会主动去读取这个区块的信息，这样系统才能知道你的程序放在哪里、该如何进行开机。

### 磁盘分区表

如何切割硬盘？
利用参考对照磁柱号码的方式来处理。在分割表所在的64 bytes容量中，总共分为4组记录区，每组记录去记录了该区段的开始与结束的磁柱号码。

重要信息：
- 分割只是针对分割表进行设定。
- 硬盘默认的分割表最多写入4组分割信息（第一扇区的分割表）
- 这4组分割信息我们称为主要（primary)或延伸（extended)分割槽
- 分割槽的最小单位是磁柱（cylinder)
- 当系统要写入磁盘时，一定会参考磁盘分区表，才能针对某个分割槽进行数据处理

分割磁盘的原因：
1. 数据的安全性
2. 系统的效能考虑

延伸分割：
因为第一扇区所在的分割表只能记录四笔数据，要想记录更多的分割信息可以用额外的扇区来记录。使用额外的扇区来记录分割信息为延伸分割。

逻辑分割槽：延伸分割出来的分割槽。逻辑分割的数量依操作系统而不同，IDE最多59（5号-63号），SATA硬盘则有11和（5号-15号）

可以格式化的是主要分割槽和逻辑分割槽，延伸分割槽不可格式化。

### 开机流程与MBR
1. BIOS：开机主动执行的韧体（韧体是写在硬件上的一个软件程序），会认识地一个可开机的装置；
2. MBR： 第一个可开机装置的第一个扇区内的主要启动记录区块，内涵开机管理程序；
3. 开机管理程序（boot loader）：一支可以读取核心档案来执行的软件；
4. 核心档案：开始操作系统的功能。


boot loader的主要任务有：
1. 提供选单：用户可以选择不同的开机项目，这也是多重引导的重要功能。
2. 载入核心档案：直接只想可开机的程序区段来进行操作系统。
3. 转交给其他loader：将开机管理功能转交给其他的Loader负责。（开机管理程序不仅可以安在MBR,还可以安装在每个分割槽的启动扇区。

**问题：**
如果要安装多重引导，为什么最好先安装Windows再安装linux呢？

```
因为：
- Linux在安装的时候，你可以选择将开机管理程序安装在MBR或别的分割槽的启动扇区，而且Linux的Loader可以手动设定选单，所以你可以在Linux的boot loader中加入Windows开机选项;

- Windows 在安装的时候，它的安装程序会主动覆盖掉MBR以及自己所在分割槽的启动扇形区。你没有选择的机会。

因此，如果先安装Linux再安装Windows的话，那么MBR的开机管理程序就只会有Windows的项目，而不会有linux的项目（因为原本在MBR内的Linux的开机管理程序就会被覆盖掉）

```

### Linux安装模式下，磁盘分区的选择（极为重要）

* 目录树结构（directory tree)
	以根目录（/）为主，然后向下呈现分支状的目录结构的一种档案架构。

* 文件系统与目录树的关系（挂载）

	挂载：利用一个目录当成进入点，将磁盘分区槽的数据放置在该目录下，即：进入该目录就可以读取该分割槽。这个动作称为挂载，那个目录称为挂载点。

* distributions 安装时，挂载点与磁盘分区的规划：
 - 自定义安装**Custom**：
    + A: 初次接触Linux:只分割**/** 和 **swap**;
    + B: 建议分割的方法:预留一个备用的剩余磁盘容量。（可做分割练习）

## 安装Linux前的规划

### 选择适当的distribution
### 打造Windows 与linux共存的环境
### 主机硬盘的主要规划















